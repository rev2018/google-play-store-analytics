<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Google Play Store Dashboard</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script>
    function toggleTheme() {
      document.documentElement.classList.toggle('dark');
    }
  </script>
  <style>
    .dark body {
      background-color: #1f2937;
      color: white;
    }
  </style>
</head>

<body class="p-4">
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold">ðŸ“± Google Play Store Data Analysis</h1>
    <button onclick="toggleTheme()" class="bg-indigo-500 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded">Toggle Dark Mode</button>
  </div>

  <div id="ratingDist" class="mb-10"></div>
  <div id="topCategories" class="mb-10"></div>
  <div id="avgRating" class="mb-10"></div>
  <div id="mostInstalled" class="mb-10"></div>
  <div id="priceDist" class="mb-10"></div>

  <footer class="text-center mt-10 border-t pt-4">
    Created by <a class="text-blue-400 underline" href="https://www.linkedin.com/in/reva-saxena-61bb33342/" target="_blank">Reva</a>
  </footer>

  <script>
    const dataUrl = 'https://raw.githubusercontent.com/rev2018/google-play-store-analytics/main/googleplaystore.csv';

    Papa.parse(dataUrl, {
      download: true,
      header: true,
      complete: function (results) {
        const data = results.data.filter(row => row.Rating && !isNaN(parseFloat(row.Rating)));

        // Distribution of Ratings
        const ratings = data.map(d => parseFloat(d.Rating));
        Plotly.newPlot('ratingDist', [{
          x: ratings,
          type: 'histogram',
          marker: { color: '#3b82f6' }
        }], {
          title: 'Distribution of App Ratings',
          paper_bgcolor: 'transparent',
          plot_bgcolor: 'transparent'
        });

        // Top Categories
        const categoryCounts = {};
        data.forEach(d => {
          categoryCounts[d.Category] = (categoryCounts[d.Category] || 0) + 1;
        });
        const sortedCategories = Object.entries(categoryCounts).sort((a, b) => b[1] - a[1]).slice(0, 10);
        Plotly.newPlot('topCategories', [{
          x: sortedCategories.map(e => e[0]),
          y: sortedCategories.map(e => e[1]),
          type: 'bar',
          marker: { color: '#10b981' }
        }], {
          title: 'Top 10 Categories by App Count',
          paper_bgcolor: 'transparent',
          plot_bgcolor: 'transparent'
        });

        // Average Rating by Category
        const ratingByCat = {};
        data.forEach(d => {
          const r = parseFloat(d.Rating);
          if (!ratingByCat[d.Category]) ratingByCat[d.Category] = [];
          ratingByCat[d.Category].push(r);
        });
        const avgRatings = Object.entries(ratingByCat).map(([cat, vals]) => [cat, vals.reduce((a, b) => a + b, 0) / vals.length]);
        const topAvg = avgRatings.sort((a, b) => b[1] - a[1]).slice(0, 10);
        Plotly.newPlot('avgRating', [{
          x: topAvg.map(e => e[0]),
          y: topAvg.map(e => e[1]),
          type: 'bar',
          marker: { color: '#f59e0b' }
        }], {
          title: 'Top 10 Categories by Average Rating',
          paper_bgcolor: 'transparent',
          plot_bgcolor: 'transparent'
        });

        // Most Installed Apps
        const cleanInstalls = data.filter(d => d.Installs && !d.Installs.includes('Free'))
          .map(d => ({
            App: d.App,
            Installs: parseInt(d.Installs.replace(/[^\d]/g, '')),
            Category: d.Category
          }));
        const topInstalled = cleanInstalls.sort((a, b) => b.Installs - a.Installs).slice(0, 10);
        Plotly.newPlot('mostInstalled', [{
          x: topInstalled.map(d => d.App),
          y: topInstalled.map(d => d.Installs),
          type: 'bar',
          marker: { color: '#8b5cf6' }
        }], {
          title: 'Top 10 Most Installed Apps',
          paper_bgcolor: 'transparent',
          plot_bgcolor: 'transparent'
        });

        // Price Distribution of Paid Apps
        const paidApps = data.filter(d => d.Type === 'Paid' && parseFloat(d.Price) < 100);
        const prices = paidApps.map(d => parseFloat(d.Price));
        Plotly.newPlot('priceDist', [{
          x: prices,
          type: 'histogram',
          marker: { color: '#ef4444' }
        }], {
          title: 'Price Distribution of Paid Apps (Under $100)',
          paper_bgcolor: 'transparent',
          plot_bgcolor: 'transparent'
        });
      }
    });
  </script>
</body>

</html>
